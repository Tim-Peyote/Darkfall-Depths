# Darkfall Depths - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–µ—Ö–∞–Ω–∏–∫

## üìÖ –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–ê–≤–≥—É—Å—Ç 2025)

### üÜï –ù–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã
- **üé® –°–∏—Å—Ç–µ–º–∞ —Ñ–æ–Ω–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** - –∫—Ä–∞—Å–∏–≤—ã–π —Ñ–æ–Ω –¥–ª—è –º–µ–Ω—é –∏ –≤—ã–±–æ—Ä–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
- **üéµ –ê—É–¥–∏–æ —Å–∏—Å—Ç–µ–º–∞ v2.0** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Å –±–æ–≥–∞—Ç—ã–º —Å–∞—É–Ω–¥ –¥–∏–∑–∞–π–Ω–æ–º
- **üß™ –°–∏—Å—Ç–µ–º–∞ –±–∞–Ω–æ–∫ –∑–¥–æ—Ä–æ–≤—å—è** - Diablo-style —Ö–æ—Ç–∫–µ–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- **üíö –£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∑–¥–æ—Ä–æ–≤—å—è** - –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ maxHp –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ–∂–¥—É —É—Ä–æ–≤–Ω—è–º–∏

### üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞—É–¥–∏–æ** - –æ–±—Ö–æ–¥ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –±—Ä–∞—É–∑–µ—Ä–∞
- **–°–∏—Å—Ç–µ–º–∞ –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞—É–¥–∏–æ** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∏
- **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å UI** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∑–≤—É–∫–æ–≤** - —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–≤—É–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –∏ —Å–æ–±—ã—Ç–∏—è

### üéÆ –ò–≥—Ä–æ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏** - –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å –Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –º–µ–∂–¥—É —É—Ä–æ–≤–Ω—è–º–∏
- **–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å** - –ø–ª–∞–≤–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–∞–≥–æ–≤
- **–£–ª—É—á—à–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã** - —à–∞–Ω—Å –Ω–∞–π—Ç–∏ –ø—Ä–µ–¥–º–µ—Ç—ã –Ω–∞ —É—Ä–æ–≤–µ–Ω—å –≤—ã—à–µ
- **–í–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã** - –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π —Å —Ñ–æ–∫—É—Å–æ–º

## üèóÔ∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤
```
Vers_1.9/
‚îú‚îÄ‚îÄ js/
‚îÇ   ‚îú‚îÄ‚îÄ main.js                    # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –∏–≥—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ audio/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AudioManager.js        # –ê—É–¥–∏–æ —Å–∏—Å—Ç–µ–º–∞ v2.0
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ constants.js           # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GameState.js           # –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ObjectPool.js          # Object Pool –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ effects/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Particle.js            # –°–∏—Å—Ç–µ–º–∞ —á–∞—Å—Ç–∏—Ü
‚îÇ   ‚îú‚îÄ‚îÄ entities/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Entity.js              # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å —Å—É—â–Ω–æ—Å—Ç–µ–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Player.js              # –ò–≥—Ä–æ–∫
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Enemy.js               # –í—Ä–∞–≥–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Projectile.js          # –°–Ω–∞—Ä—è–¥—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DroppedItem.js         # –ü—Ä–µ–¥–º–µ—Ç—ã –Ω–∞ –∑–µ–º–ª–µ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Portal.js              # –ü–æ—Ä—Ç–∞–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ game/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GameEngine.js          # –ò–≥—Ä–æ–≤–æ–π –¥–≤–∏–∂–æ–∫
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ LevelManager.js        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ input/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ InputManager.js        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–≤–æ–¥–æ–º
‚îÇ   ‚îú‚îÄ‚îÄ map/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MapGenerator.js        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–¥–∑–µ–º–µ–ª–∏–π
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ FogOfWar.js            # –¢—É–º–∞–Ω –≤–æ–π–Ω—ã
‚îÇ   ‚îú‚îÄ‚îÄ ui/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ScreenManager.js       # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞–º–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ InventoryManager.js    # –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ContextMenuManager.js  # –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –º–µ–Ω—é
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MenuNavigationManager.js # –ù–∞–≤–∏–≥–∞—Ü–∏—è –º–µ–Ω—é
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RecordsManager.js      # –†–µ–∫–æ—Ä–¥—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ SettingsManager.js     # –ù–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ       ‚îî‚îÄ‚îÄ Utils.js               # –£—Ç–∏–ª–∏—Ç—ã
‚îú‚îÄ‚îÄ Audio/
‚îÇ   ‚îú‚îÄ‚îÄ Main.mp3                   # –ì–ª–∞–≤–Ω–∞—è —Ç–µ–º–∞
‚îÇ   ‚îú‚îÄ‚îÄ stage1.mp3                 # –ú—É–∑—ã–∫–∞ –∏–≥—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ GameOver.mp3               # –ú—É–∑—ã–∫–∞ –≥–µ–π–º–æ–≤–µ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ Level_Complite.mp3         # –ú—É–∑—ã–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è
‚îÇ   ‚îî‚îÄ‚îÄ Fx/                        # –ó–≤—É–∫–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
‚îú‚îÄ‚îÄ Assets/
‚îÇ   ‚îú‚îÄ‚îÄ Main.png                   # –§–æ–Ω –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é
‚îÇ   ‚îî‚îÄ‚îÄ Characters.png             # –§–æ–Ω –≤—ã–±–æ—Ä–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
‚îú‚îÄ‚îÄ index.html                     # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îú‚îÄ‚îÄ style.css                      # –°—Ç–∏–ª–∏
‚îî‚îÄ‚îÄ README.md                      # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

### –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **ES6 –º–æ–¥—É–ª–∏** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏–º–ø–æ—Ä—Ç–æ–≤/—ç–∫—Å–ø–æ—Ä—Ç–æ–≤
- **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏** - –∫–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–≤–æ—é –æ–±–ª–∞—Å—Ç—å
- **–°–ª–∞–±–∞—è —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å** - –º–æ–¥—É–ª–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç —á–µ—Ä–µ–∑ —á–µ—Ç–∫–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
- **–í—ã—Å–æ–∫–∞—è –∫–æ–≥–µ–∑–∏—è** - —Å–≤—è–∑–∞–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç—Å—è –≤ –æ–¥–Ω–æ–º –º–æ–¥—É–ª–µ

## üé® –°–ò–°–¢–ï–ú–ê –§–û–ù–û–í–´–• –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ô

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤
```
Assets/
‚îú‚îÄ‚îÄ Main.png          # –§–æ–Ω –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é –∏ —ç–∫—Ä–∞–Ω–æ–≤ –Ω–∞—Å—Ç—Ä–æ–µ–∫/—Ä–µ–∫–æ—Ä–¥–æ–≤
‚îî‚îÄ‚îÄ Characters.png    # –§–æ–Ω —ç–∫—Ä–∞–Ω–∞ –≤—ã–±–æ—Ä–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
```

### HTML —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —ç–∫—Ä–∞–Ω–æ–≤
```html
<!-- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é -->
<div id="menuScreen" class="screen">
  <div class="menu-background"></div>
  <div class="menu-content">
    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –º–µ–Ω—é -->
  </div>
</div>

<!-- –í—ã–±–æ—Ä –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π -->
<div id="selectScreen" class="screen">
  <div class="select-background"></div>
  <div class="select-content">
    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –≤—ã–±–æ—Ä–∞ -->
  </div>
</div>
```

### CSS —Å—Ç–∏–ª–∏ —Ñ–æ–Ω–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
```css
/* –£–±–∏—Ä–∞–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è —ç–∫—Ä–∞–Ω–æ–≤ —Å —Ñ–æ–Ω–æ–≤—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ */
#menuScreen, #selectScreen, #settingsScreen, #recordsScreen {
  background: none;
}

/* –§–æ–Ω–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è */
.menu-background, .select-background, .settings-background, .records-background {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  z-index: 0;
}

/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
.menu-content, .select-content, .settings-content, .records-content {
  position: relative;
  z-index: 1;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}
```

### –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –∫–∞—Ä—Ç–æ—á–µ–∫ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
```css
/* –û–±—ã—á–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ - –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ */
.character-card {
  background: linear-gradient(145deg, rgba(255, 255, 255, 0.05), rgba(0, 0, 0, 0.2));
  backdrop-filter: blur(10px);
}

/* –ö–∞—Ä—Ç–æ—á–∫–∞ —Å —Ñ–æ–∫—É—Å–æ–º - –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ–∑—Ä–∞—á–Ω–∞—è */
.character-card.keyboard-focus {
  background: transparent;
  backdrop-filter: none;
}
```

### –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å
```css
@media (max-width: 768px) {
  .menu-background, .select-background, .settings-background, .records-background {
    background-size: cover;
    background-position: center;
  }
}
```

## üéµ –ê–£–î–ò–û –°–ò–°–¢–ï–ú–ê V2.0

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∞—É–¥–∏–æ —Ñ–∞–π–ª–æ–≤
```
Audio/
‚îú‚îÄ‚îÄ Main.mp3              # –ì–ª–∞–≤–Ω–∞—è —Ç–µ–º–∞ (–º–µ–Ω—é)
‚îú‚îÄ‚îÄ stage1.mp3            # –ú—É–∑—ã–∫–∞ –∏–≥—Ä—ã
‚îú‚îÄ‚îÄ GameOver.mp3          # –ú—É–∑—ã–∫–∞ –≥–µ–π–º–æ–≤–µ—Ä–∞
‚îú‚îÄ‚îÄ Level_Complite.mp3    # –ú—É–∑—ã–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è
‚îî‚îÄ‚îÄ Fx/
    ‚îú‚îÄ‚îÄ Inventory_open.mp3
    ‚îú‚îÄ‚îÄ health_potion.mp3
    ‚îú‚îÄ‚îÄ enemy_die.mp3
    ‚îú‚îÄ‚îÄ enemy_hit.mp3
    ‚îú‚îÄ‚îÄ heroes_hit.mp3
    ‚îú‚îÄ‚îÄ Heroes_die.mp3
    ‚îú‚îÄ‚îÄ Dagger.mp3
    ‚îú‚îÄ‚îÄ Fireball.mp3
    ‚îú‚îÄ‚îÄ sword.mp3
    ‚îú‚îÄ‚îÄ Armor.mp3
    ‚îú‚îÄ‚îÄ Dash.mp3
    ‚îú‚îÄ‚îÄ explosion.mp3
    ‚îî‚îÄ‚îÄ item_pickup.mp3
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
```javascript
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∞—É–¥–∏–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
createAudioContextAndPlay() {
  this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
  
  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –º—É–∑—ã–∫–∏
  if (gameState.audio.enabled && this.isMusicLoaded) {
    this.playMusic('main');
  }
}
```

### –°–∏—Å—Ç–µ–º–∞ –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞—É–¥–∏–æ
```javascript
setupAudioResumeHandlers() {
  const resumeAudio = () => {
    if (this.audioContext && this.audioContext.state === 'suspended') {
      this.audioContext.resume();
    }
    if (this.currentMusic && this.currentMusic.paused && gameState.audio.enabled) {
      this.currentMusic.play();
    }
  };

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
  ['click', 'touchstart', 'keydown', 'mousedown'].forEach(event => {
    document.addEventListener(event, resumeAudio, { once: false });
  });
}
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∏–≥—Ä–æ–≤—ã–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–±—ã—Ç–∏—è:**
- –û—Ç–∫—Ä—ã—Ç–∏–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è ‚Üí `playInventoryOpen()`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∑–µ–ª—å—è –∑–¥–æ—Ä–æ–≤—å—è ‚Üí `playHealthPotion()`
- –ü–æ–¥–±–æ—Ä –ø—Ä–µ–¥–º–µ—Ç–æ–≤ ‚Üí `playItemPickup()`

**–ë–æ–µ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è:**
- –ê—Ç–∞–∫–∞ Andre (–º–µ—á) ‚Üí `playSwordAttack()`
- –ê—Ç–∞–∫–∞ Tim (–∫–∏–Ω–∂–∞–ª) ‚Üí `playDaggerAttack()`
- –ê—Ç–∞–∫–∞ Dimon (–æ–≥–Ω–µ–Ω–Ω—ã–π —à–∞—Ä) ‚Üí `playFireballAttack()`
- –ü–æ–ø–∞–¥–∞–Ω–∏–µ –ø–æ –≤—Ä–∞–≥—É ‚Üí `playEnemyHit()`
- –°–º–µ—Ä—Ç—å –≤—Ä–∞–≥–∞ ‚Üí `playEnemyDie()`
- –ü–æ–ª—É—á–µ–Ω–∏–µ —É—Ä–æ–Ω–∞ –≥–µ—Ä–æ–µ–º ‚Üí `playHeroesHit()`
- –°–º–µ—Ä—Ç—å –≥–µ—Ä–æ—è ‚Üí `playHeroesDie()`

**–ò–≥—Ä–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è:**
- –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è ‚Üí `playLevelComplete()`
- –ì–µ–π–º–æ–≤–µ—Ä ‚Üí `playGameOver()`

## üß™ –°–ò–°–¢–ï–ú–ê –ë–ê–ù–û–ö –ó–î–û–†–û–í–¨–Ø (Diablo-style)

### HTML —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
```html
<div class="health-potions-bottom">
  <div id="healthPotionSlot" class="potion-slot">
    <div class="potion-icon">üß™</div>
    <div id="potionCount" class="potion-count">0</div>
    <div class="potion-hotkey">1</div>
  </div>
</div>
```

### CSS —Å—Ç–∏–ª–∏
```css
.health-potions-bottom {
  position: absolute;
  bottom: var(--space-20);
  left: var(--space-20);
  z-index: 40;
  pointer-events: auto;
}

.potion-slot {
  position: relative;
  width: 48px;
  height: 48px;
  background: rgba(0, 0, 0, 0.7);
  border: 2px solid var(--color-error);
  border-radius: var(--radius-base);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
}

.potion-slot.empty {
  opacity: 0.5;
  cursor: not-allowed;
}

.potion-count {
  position: absolute;
  bottom: -2px;
  right: -2px;
  background: var(--color-error);
  color: var(--color-cream-50);
  font-size: var(--font-size-xs);
  font-weight: var(--font-weight-bold);
  padding: 2px 4px;
  border-radius: var(--radius-sm);
  min-width: 16px;
  text-align: center;
}

.potion-hotkey {
  position: absolute;
  top: -2px;
  left: -2px;
  background: rgba(0, 0, 0, 0.8);
  color: var(--color-cream-50);
  font-size: var(--font-size-xs);
  font-weight: var(--font-weight-bold);
  padding: 2px 4px;
  border-radius: var(--radius-sm);
  min-width: 12px;
  text-align: center;
}
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –±–∞–Ω–æ–∫
```javascript
static updateHealthPotions() {
  let healthPotionCount = 0;
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä—é–∫–∑–∞–∫
  gameState.inventory.backpack.forEach(item => {
    if (item && item.bonus && item.bonus.heal) {
      healthPotionCount++;
    }
  });
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —ç–∫–∏–ø–∏—Ä–æ–≤–∫—É (—Ä–∞—Å—Ö–æ–¥–Ω–∏–∫–∏)
  if (gameState.inventory.equipment[3] && 
      gameState.inventory.equipment[3].bonus && 
      gameState.inventory.equipment[3].bonus.heal) {
    healthPotionCount++;
  }
  
  // –û–±–Ω–æ–≤–ª—è–µ–º UI
  potionCount.textContent = healthPotionCount;
  
  if (healthPotionCount > 0) {
    potionSlot.classList.remove('empty');
  } else {
    potionSlot.classList.add('empty');
  }
}
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∞–Ω–æ–∫
```javascript
static useHealthPotion() {
  // –ò—â–µ–º –±–∞–Ω–∫—É –≤ —Ä—é–∫–∑–∞–∫–µ
  for (let i = 0; i < gameState.inventory.backpack.length; i++) {
    const item = gameState.inventory.backpack[i];
    if (item && item.bonus && item.bonus.heal) {
      // –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–∞–Ω–∫—É
      gameState.player.hp = Math.min(gameState.player.maxHp, 
                                     gameState.player.hp + item.bonus.heal);
      
      // –£–¥–∞–ª—è–µ–º –±–∞–Ω–∫—É –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
      gameState.inventory.backpack[i] = null;
      
      // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –∑–≤—É–∫
      audioManager.playHealthPotion();
      
      // –û–±–Ω–æ–≤–ª—è–µ–º UI
      this.updateHealthPotions();
      return;
    }
  }
}
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
**–•–æ—Ç–∫–µ–∏:**
- **–ö–ª–∞–≤–∏—à–∞ "1"** - `Digit1`
- **–ö–ª–∞–≤–∏—à–∞ "Q"** - `KeyQ`
- **–ö–ª–∏–∫ –ø–æ —è—á–µ–π–∫–µ** - –ø—Ä—è–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

**–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å:**
```css
@media (max-width: 768px) {
  .health-potions-bottom {
    bottom: var(--space-16);
    left: var(--space-16);
  }
}

@media (max-width: 480px) {
  .health-potions-bottom {
    bottom: var(--space-12);
    left: var(--space-12);
  }
  
  .potion-slot {
    width: 40px;
    height: 40px;
  }
}
```

## üíö –£–õ–£–ß–®–ï–ù–ù–ê–Ø –°–ò–°–¢–ï–ú–ê –ó–î–û–†–û–í–¨–Ø

### –õ–æ–≥–∏–∫–∞ maxHp
```javascript
// –ü—Ä–µ–¥–º–µ—Ç—ã —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç —à–∫–∞–ª—É, –Ω–æ –ù–ï –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç –∑–¥–æ—Ä–æ–≤—å–µ
case 'maxHp':
  gameState.player.maxHp += value;
  // –¢–µ–∫—É—â–µ–µ –∑–¥–æ—Ä–æ–≤—å–µ –æ—Å—Ç–∞–µ—Ç—Å—è –ø—Ä–µ–∂–Ω–∏–º
  break;
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ–∂–¥—É —É—Ä–æ–≤–Ω—è–º–∏
```javascript
// –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ 30% –æ—Ç –º–∞–∫—Å–∏–º—É–º–∞ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å
const healAmount = Math.floor(gameState.player.maxHp * 0.3);
gameState.player.hp = Math.min(gameState.player.maxHp, 
                               gameState.player.hp + healAmount);
```

## üè∞ –°–ò–°–¢–ï–ú–ê –ì–ï–ù–ï–†–ê–¶–ò–ò –ü–û–î–ó–ï–ú–ï–õ–ò–ô (MapGenerator)

### –ê–ª–≥–æ—Ä–∏—Ç–º BSP (Binary Space Partitioning)

**–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:**
1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**: –ö–∞—Ä—Ç–∞ 50x50 —Ç–∞–π–ª–æ–≤ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å—Ç–µ–Ω–∞–º–∏ (–∑–Ω–∞—á–µ–Ω–∏–µ 1)
2. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞**: –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã –Ω–∞ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω—ã–µ —Å–µ–∫—Ü–∏–∏
3. **–°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç**: –í –∫–∞–∂–¥–æ–π —Å–µ–∫—Ü–∏–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–æ–º–Ω–∞—Ç–∞ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
4. **–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫–æ—Ä–∏–¥–æ—Ä–∞–º–∏**: L-–æ–±—Ä–∞–∑–Ω—ã–µ –∫–æ—Ä–∏–¥–æ—Ä—ã —Å–æ–µ–¥–∏–Ω—è—é—Ç —Ü–µ–Ω—Ç—Ä—ã –∫–æ–º–Ω–∞—Ç

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```javascript
const MAP_SIZE = 50;           // –†–∞–∑–º–µ—Ä –∫–∞—Ä—Ç—ã –≤ —Ç–∞–π–ª–∞—Ö
const ROOM_MIN_SIZE = 6;       // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∫–æ–º–Ω–∞—Ç—ã
const ROOM_MAX_SIZE = 12;      // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∫–æ–º–Ω–∞—Ç—ã
const MIN_ROOMS = 8;           // –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç
const MAX_ROOMS = 12;          // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç
```

**–ü—Ä–æ—Ü–µ—Å—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:**
1. **splitPartition()** - —Ä–∞–∑–¥–µ–ª—è–µ—Ç –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω—É—é –æ–±–ª–∞—Å—Ç—å –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏
2. **createRoomInPartition()** - —Å–æ–∑–¥–∞–µ—Ç –∫–æ–º–Ω–∞—Ç—É –≤ –∑–∞–¥–∞–Ω–Ω–æ–π —Å–µ–∫—Ü–∏–∏
3. **carveRoom()** - –≤—ã—Ä–µ–∑–∞–µ—Ç –∫–æ–º–Ω–∞—Ç—É –≤ –∫–∞—Ä—Ç–µ (–∑–∞–º–µ–Ω—è–µ—Ç —Å—Ç–µ–Ω—ã –Ω–∞ –ø–æ–ª)
4. **connectRooms()** - —Å–æ–µ–¥–∏–Ω—è–µ—Ç –∫–æ–º–Ω–∞—Ç—ã –∫–æ—Ä–∏–¥–æ—Ä–∞–º–∏
5. **createCorridor()** - —Å–æ–∑–¥–∞–µ—Ç L-–æ–±—Ä–∞–∑–Ω—ã–π –∫–æ—Ä–∏–¥–æ—Ä –º–µ–∂–¥—É –¥–≤—É–º—è —Ç–æ—á–∫–∞–º–∏

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–º–Ω–∞—Ç—ã:**
```javascript
{
  x: number,           // X –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ –ª–µ–≤–æ–≥–æ –≤–µ—Ä—Ö–Ω–µ–≥–æ —É–≥–ª–∞
  y: number,           // Y –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ –ª–µ–≤–æ–≥–æ –≤–µ—Ä—Ö–Ω–µ–≥–æ —É–≥–ª–∞
  width: number,       // –®–∏—Ä–∏–Ω–∞ –∫–æ–º–Ω–∞—Ç—ã
  height: number,      // –í—ã—Å–æ—Ç–∞ –∫–æ–º–Ω–∞—Ç—ã
  centerX: number,     // X –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ —Ü–µ–Ω—Ç—Ä–∞
  centerY: number      // Y –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ —Ü–µ–Ω—Ç—Ä–∞
}
```

### –°–∏—Å—Ç–µ–º–∞ —Å–ø–∞–≤–Ω–∞ —Å—É—â–Ω–æ—Å—Ç–µ–π

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞:**
- –°–ø–∞–≤–Ω –≤ —Ü–µ–Ω—Ç—Ä–µ –ø–µ—Ä–≤–æ–π –∫–æ–º–Ω–∞—Ç—ã
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: `(room.centerX + 0.5) * TILE_SIZE`

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤—Ä–∞–≥–æ–≤:**
- –°–ø–∞–≤–Ω –≤ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∫–æ–º–Ω–∞—Ç–∞—Ö (—Å–æ 2-–π –ø–æ –ø–æ—Å–ª–µ–¥–Ω—é—é)
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ä–∞–≥–æ–≤: `1-2 + Math.floor(level / 4)`
- –ü–æ–∑–∏—Ü–∏—è: —Å–ª—É—á–∞–π–Ω–∞—è —Ç–æ—á–∫–∞ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –∫–æ–º–Ω–∞—Ç—ã
- –£—Å–∏–ª–µ–Ω–∏–µ —Å —É—Ä–æ–≤–Ω–µ–º: `1 + (level - 1) * 0.2`

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø–æ—Ä—Ç–∞–ª–∞:**
- –°–ø–∞–≤–Ω –≤ —Ü–µ–Ω—Ç—Ä–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∫–æ–º–Ω–∞—Ç—ã
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: `(endRoom.centerX + 0.5) * TILE_SIZE`

### –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏ –≤—Ä–∞–≥–æ–≤

**–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:**
```javascript
// –ë–∞–∑–æ–≤—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
const baseMultiplier = 1 + (gameState.level - 1) * 0.12;

// –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å –¥–ª—è –≤—ã—Å–æ–∫–∏—Ö —É—Ä–æ–≤–Ω–µ–π
const highLevelBonus = gameState.level >= 10 ? (gameState.level - 10) * 0.05 : 0;
const totalMultiplier = baseMultiplier + highLevelBonus;

// –£—Å–∏–ª–µ–Ω–∏–µ –≤—Ä–∞–≥–æ–≤
enemy.hp = Math.floor(enemy.hp * totalMultiplier);
enemy.damage = Math.floor(enemy.damage * totalMultiplier);

// –£—Å–∫–æ—Ä–µ–Ω–∏–µ –Ω–∞ –≤—ã—Å–æ–∫–∏—Ö —É—Ä–æ–≤–Ω—è—Ö
if (gameState.level >= 5) {
  const speedBonus = Math.min(0.3, (gameState.level - 5) * 0.02);
  enemy.speed = Math.floor(enemy.speed * (1 + speedBonus));
}
```

**–°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–º–µ—Ç–æ–≤:**
```javascript
// –®–∞–Ω—Å –ø–æ—è–≤–ª–µ–Ω–∏—è –ø—Ä–µ–¥–º–µ—Ç–æ–≤
const baseItemChance = 0.3;
const levelBonus = Math.min(0.4, gameState.level * 0.03);
const itemChance = baseItemChance + levelBonus;

// –ö–∞—á–µ—Å—Ç–≤–æ –ø—Ä–µ–¥–º–µ—Ç–æ–≤
const minItemLevel = Math.max(1, gameState.level - 1);
const maxItemLevel = gameState.level + 1; // –ü—Ä–µ–¥–º–µ—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–∞ —É—Ä–æ–≤–µ–Ω—å –≤—ã—à–µ
```

## üå´Ô∏è –°–ò–°–¢–ï–ú–ê –¢–£–ú–ê–ù–ê –í–û–ô–ù–´ (FogOfWar)

### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

**–î–≤–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏:**
1. **explored[y][x]** - –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–Ω–∞—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è (true/false)
2. **visible[y][x]** - –≤–∏–¥–∏–º–∞—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è (true/false)

**–ê–ª–≥–æ—Ä–∏—Ç–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏:**
```javascript
updateVisibility(playerX, playerY, radius = 6)
```

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. **–û—á–∏—Å—Ç–∫–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏**: `visible[y][x] = false` –¥–ª—è –≤—Å–µ—Ö —Ç–∞–π–ª–æ–≤
2. **–†–∞—Å—á–µ—Ç —Ü–µ–Ω—Ç—Ä–∞**: `centerTileX = Math.floor(playerX / TILE_SIZE)`
3. **–ö—Ä—É–≥–æ–≤–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Ç–∞–π–ª–æ–≤ –≤ —Ä–∞–¥–∏—É—Å–µ 6
4. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏**: `visible[tileY][tileX] = true`
5. **–û—Ç–º–µ—Ç–∫–∞ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è**: `explored[tileY][tileX] = true`

**–†–∞–¥–∏—É—Å –≤–∏–¥–∏–º–æ—Å—Ç–∏:**
- **–ë–∞–∑–æ–≤—ã–π —Ä–∞–¥–∏—É—Å**: 6 —Ç–∞–π–ª–æ–≤
- **–†–∞—Å—á–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è**: `Math.hypot(dx, dy) <= radius`
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—Ü**: `tileX >= 0 && tileX < MAP_SIZE`

### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ç—É–º–∞–Ω–∞ –≤–æ–π–Ω—ã

**–¢—Ä–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏:**
1. **–ù–µ–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–Ω–∞—è –æ–±–ª–∞—Å—Ç—å**: `rgba(0, 0, 0, 0.9)` - –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ç–µ–º–Ω–∞—è
2. **–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–Ω–∞—è –Ω–æ –Ω–µ –≤–∏–¥–∏–º–∞—è**: `rgba(0, 0, 0, 0.6)` - –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω–∞—è
3. **–í–∏–¥–∏–º–∞—è –æ–±–ª–∞—Å—Ç—å**: –ë–µ–∑ –Ω–∞–ª–æ–∂–µ–Ω–∏—è (–ø—Ä–æ–∑—Ä–∞—á–Ω–∞—è)

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞:**
- –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ç–æ–ª—å–∫–æ –≤–∏–¥–∏–º—ã—Ö —Ç–∞–π–ª–æ–≤ –Ω–∞ —ç–∫—Ä–∞–Ω–µ
- –†–∞—Å—á–µ—Ç –≤–∏–¥–∏–º–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞: `startX/endX, startY/endY`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—Ü —ç–∫—Ä–∞–Ω–∞ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## üó∫Ô∏è –°–ò–°–¢–ï–ú–ê –û–¢–†–ò–°–û–í–ö–ò –ö–ê–†–¢–´

### –û—Å–Ω–æ–≤–Ω–∞—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –∫–∞—Ä—Ç—ã (renderMap)

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**
```javascript
const startX = Math.floor(camera.x / TILE_SIZE) - 1;
const endX = Math.floor((camera.x + canvas.width / DPR) / TILE_SIZE) + 1;
```

**–û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ç–∞–π–ª–æ–≤:**
- **–°—Ç–µ–Ω—ã** (–∑–Ω–∞—á–µ–Ω–∏–µ 1): `#2c3e50` —Å –≥—Ä–∞–Ω–∏—Ü–∞–º–∏ `#34495e`
- **–ü–æ–ª** (–∑–Ω–∞—á–µ–Ω–∏–µ 0): `#555` —Å —Å–µ—Ç–∫–æ–π `#666`
- **–≠–∫—Ä–∞–Ω–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã**: `x * TILE_SIZE - camera.x`

**–°–∏—Å—Ç–µ–º–∞ –∫–∞–º–µ—Ä—ã:**
- **–ü–ª–∞–≤–Ω–æ–µ —Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ**: `Utils.lerp(camera.x, targetX, dt * 5)`
- **–¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ**: `targetX = player.x - canvas.width / (2 * DPR)`
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**: –ö–∞–º–µ—Ä–∞ –Ω–µ –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã –∫–∞—Ä—Ç—ã

### –ú–∏–Ω–∏–∫–∞—Ä—Ç–∞ (renderMinimap)

**–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```javascript
const scale = minimapCanvas.width / MAP_SIZE;
```

**–¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞ –º–∏–Ω–∏–∫–∞—Ä—Ç—ã:**
- **–í–∏–¥–∏–º—ã–π –ø–æ–ª**: `#95a5a6`
- **–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª**: `#34495e`
- **–í–∏–¥–∏–º–∞—è —Å—Ç–µ–Ω–∞**: `#2c3e50`
- **–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–µ–Ω–∞**: `#1a1a1a`

**–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–µ–π:**
- **–ò–≥—Ä–æ–∫**: –ö—Ä–∞—Å–Ω—ã–π –∫–≤–∞–¥—Ä–∞—Ç 4x4 –ø–∏–∫—Å–µ–ª—è
- **–í—Ä–∞–≥–∏**: –¢–µ–º–Ω–æ-–∫—Ä–∞—Å–Ω—ã–π –∫–≤–∞–¥—Ä–∞—Ç 2x2 –ø–∏–∫—Å–µ–ª—è
- **–ü–æ—Ä—Ç–∞–ª**: –§–∏–æ–ª–µ—Ç–æ–≤—ã–π –∫–≤–∞–¥—Ä–∞—Ç 4x4 –ø–∏–∫—Å–µ–ª—è

**–£—Å–ª–æ–≤–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è:**
- –°—É—â–Ω–æ—Å—Ç–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –≤–∏–¥–∏–º—ã—Ö –æ–±–ª–∞—Å—Ç—è—Ö
- –ü—Ä–æ–≤–µ—Ä–∫–∞: `fogOfWar.visible[entityTileY][entityTileX]`

## üéÆ –°–ò–°–¢–ï–ú–ê –£–ü–†–ê–í–õ–ï–ù–ò–Ø

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–º–µ—Ä–æ–π

**–ü–ª–∞–≤–Ω–æ–µ —Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ:**
```javascript
gameState.camera.x = Utils.lerp(gameState.camera.x, targetX, dt * 5);
gameState.camera.y = Utils.lerp(gameState.camera.y, targetY, dt * 5);
```

**–¶–µ–ª–µ–≤—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:**
- `targetX = player.x - canvas.width / (2 * DPR)`
- `targetY = player.y - canvas.height / (2 * DPR)`

**–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–ª–∞–≤–Ω–æ—Å—Ç–∏:**
- `dt * 5` - –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–ª–∞–≤–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ
- `dt` - –¥–µ–ª—å—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏ –º–µ–∂–¥—É –∫–∞–¥—Ä–∞–º–∏

### –°–∏—Å—Ç–µ–º–∞ –≤–≤–æ–¥–∞

**–ö–ª–∞–≤–∏–∞—Ç—É—Ä–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- **WASD** - –¥–≤–∏–∂–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
- **–ü—Ä–æ–±–µ–ª** - –∞—Ç–∞–∫–∞
- **E** - —É–Ω–∏–∫–∞–ª—å–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å
- **I** - –æ—Ç–∫—Ä—ã—Ç–∏–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
- **ESC** - –ø–∞—É–∑–∞/–≤–æ–∑–≤—Ä–∞—Ç –≤ –º–µ–Ω—é
- **1** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∞–Ω–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è
- **Q** - –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –∫–ª–∞–≤–∏—à–∞ –¥–ª—è –±–∞–Ω–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è

**–ú–æ–±–∏–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- **–î–∂–æ–π—Å—Ç–∏–∫** - –¥–≤–∏–∂–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
- **–ö–Ω–æ–ø–∫–∞ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏** - —É–Ω–∏–∫–∞–ª—å–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å
- **–ö–Ω–æ–ø–∫–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è** - –æ—Ç–∫—Ä—ã—Ç–∏–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è

**–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å:**
```javascript
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –¥–µ—Å–∫—Ç–æ–ø–æ–º –∏ –º–æ–±–∏–ª—å–Ω—ã–º
if (window.innerWidth <= 768) {
  showMobileControls();
} else {
  hideMobileControls();
}
```

### –°–∏—Å—Ç–µ–º–∞ —Ö–æ—Ç–∫–µ–µ–≤

**–ë–∞–Ω–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è:**
```javascript
// –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∞–≤–∏—à –¥–ª—è –±–∞–Ω–æ–∫ –∑–¥–æ—Ä–æ–≤—å—è
if (key === 'Digit1' || key === 'KeyQ') {
  GameEngine.useHealthPotion();
}
```

**–°–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏:**
```javascript
// –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∞–≤–∏—à–∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
if (key === 'KeyE' || key === 'Space') {
  player.useAbility();
}
```

## üîÑ –°–ò–°–¢–ï–ú–ê –ì–ï–ù–ï–†–ê–¶–ò–ò –£–†–û–í–ù–ï–ô

### –§—É–Ω–∫—Ü–∏—è generateLevel()

**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:**
1. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Ä—Ç—ã**: `MapGenerator.generateDungeon()`
2. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç—É–º–∞–Ω–∞ –≤–æ–π–Ω—ã**: `new FogOfWar()`
3. **–û—á–∏—Å—Ç–∫–∞ —Å—É—â–Ω–æ—Å—Ç–µ–π**: `gameState.entities = []`
4. **–°–ø–∞–≤–Ω –∏–≥—Ä–æ–∫–∞**: –í —Ü–µ–Ω—Ç—Ä–µ –ø–µ—Ä–≤–æ–π –∫–æ–º–Ω–∞—Ç—ã
5. **–°–ø–∞–≤–Ω –≤—Ä–∞–≥–æ–≤**: –í –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∫–æ–º–Ω–∞—Ç–∞—Ö
6. **–°–ø–∞–≤–Ω –ø–æ—Ä—Ç–∞–ª–∞**: –í —Ü–µ–Ω—Ç—Ä–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∫–æ–º–Ω–∞—Ç—ã
7. **–°–ø–∞–≤–Ω –ø—Ä–µ–¥–º–µ—Ç–æ–≤**: –°–ª—É—á–∞–π–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ

**–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:**
```javascript
const levelMultiplier = 1 + (gameState.level - 1) * 0.2;
enemy.hp = Math.floor(enemy.hp * levelMultiplier);
enemy.damage = Math.floor(enemy.damage * levelMultiplier);
```

**–°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–º–µ—Ç–æ–≤:**
- **–®–∞–Ω—Å –ø–æ—è–≤–ª–µ–Ω–∏—è**: `0.4 + level * 0.05` (–º–∞–∫—Å–∏–º—É–º 0.8)
- **–£—Å–∏–ª–µ–Ω–∏–µ —Å —É—Ä–æ–≤–Ω–µ–º**: –ü—Ä–µ–¥–º–µ—Ç—ã —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —Å–∏–ª—å–Ω–µ–µ
- **–ö–ª–∞—Å—Å–æ–≤—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**: –ü—Ä–µ–¥–º–µ—Ç—ã –ø–æ–¥—Ö–æ–¥—è—Ç –∫–ª–∞—Å—Å—É –∏–≥—Ä–æ–∫–∞

## üéØ –°–ò–°–¢–ï–ú–ê –ö–û–õ–õ–ò–ó–ò–ô –ò –î–í–ò–ñ–ï–ù–ò–Ø

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–ª–∏–∑–∏–π (checkCollisionWithWalls)

**–ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–æ–≤–µ—Ä–∫–∏:**
1. **–ü–µ—Ä–µ–≤–æ–¥ –≤ —Ç–∞–π–ª—ã**: `Math.floor(newX / TILE_SIZE)`
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—Ü**: `tileX >= 0 && tileX < MAP_SIZE`
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–µ–Ω**: `gameState.map[tileY][tileX] === 1`
4. **–í–æ–∑–≤—Ä–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞**: `true` –µ—Å–ª–∏ –µ—Å—Ç—å –∫–æ–ª–ª–∏–∑–∏—è

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ª—å–∫–æ —Ü–µ–ª–µ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è —Å—Ç–∞—Ç–∏—á–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
- –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—Ü –∫–∞—Ä—Ç—ã

## üé® –°–ò–°–¢–ï–ú–ê –†–ï–ù–î–ï–†–ò–ù–ì–ê

### –ò–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª (gameLoop)

**–ß–∞—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
- **–¶–µ–ª–µ–≤–æ–π FPS**: 60 –∫–∞–¥—Ä–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–µ–ª—å—Ç–∞-–≤—Ä–µ–º–µ–Ω–∏**: `Math.min(deltaTime, 1/30)`
- **–£—Å–ª–æ–≤–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥**: –¢–æ–ª—å–∫–æ –ø—Ä–∏ `gameState.gameRunning`

**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
1. **update(dt)** - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–≤–æ–π –ª–æ–≥–∏–∫–∏
2. **render()** - –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
3. **requestAnimationFrame()** - –∑–∞–ø—Ä–æ—Å —Å–ª–µ–¥—É—é—â–µ–≥–æ –∫–∞–¥—Ä–∞

## üñ•Ô∏è –°–ò–°–¢–ï–ú–ê UI –ò –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–ò

### –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω

**–ë—Ä–µ–π–∫–ø–æ–∏–Ω—Ç—ã:**
```css
/* –î–µ—Å–∫—Ç–æ–ø (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) */
@media (min-width: 769px) { /* –î–µ—Å–∫—Ç–æ–ø —Å—Ç–∏–ª–∏ */ }

/* –ü–ª–∞–Ω—à–µ—Ç */
@media (max-width: 768px) {
  .character-grid { grid-template-columns: repeat(2, 1fr); }
  .health-potions-bottom { bottom: var(--space-16); }
}

/* –ú–æ–±–∏–ª—å–Ω—ã–π */
@media (max-width: 480px) {
  .character-grid { grid-template-columns: 1fr; }
  .potion-slot { width: 40px; height: 40px; }
}
```

### –ú–æ–±–∏–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–î–∂–æ–π—Å—Ç–∏–∫:**
```css
.joystick {
  position: absolute;
  bottom: 20px;
  left: 20px;
  width: 80px;
  height: 80px;
  border: 2px solid var(--color-primary);
  border-radius: 50%;
  background: rgba(0, 0, 0, 0.5);
}

.joystick-knob {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 20px;
  height: 20px;
  background: var(--color-primary);
  border-radius: 50%;
  transform: translate(-50%, -50%);
}
```

**–ö–Ω–æ–ø–∫–∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π:**
```css
.ctrl-btn {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: var(--color-primary);
  color: var(--color-cream-50);
  font-size: 24px;
  border: none;
  cursor: pointer;
}

.ctrl-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}
```

### –§–æ–∫—É—Å –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—è

**–ö–ª–∞–≤–∏–∞—Ç—É—Ä–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è:**
```css
.keyboard-focus {
  outline: 2px solid var(--color-primary);
  outline-offset: 2px;
  animation: focusPulse 1s ease-in-out infinite;
}

@keyframes focusPulse {
  0%, 100% { box-shadow: 0 0 0 0 rgba(var(--color-primary-rgb), 0.4); }
  50% { box-shadow: 0 0 0 4px rgba(var(--color-primary-rgb), 0.4); }
}
```

**–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –∫–∞—Ä—Ç–æ—á–µ–∫ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π:**
```css
.character-card {
  background: linear-gradient(145deg, rgba(255, 255, 255, 0.05), rgba(0, 0, 0, 0.2));
  backdrop-filter: blur(10px);
}

.character-card.keyboard-focus {
  background: transparent;
  backdrop-filter: none;
}
```

### –°–∏—Å—Ç–µ–º–∞ —á–∞—Å—Ç–∏—Ü

**Object Pool –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
- **–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ**: 10 —á–∞—Å—Ç–∏—Ü –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –ß–∞—Å—Ç–∏—Ü—ã –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è/—É–Ω–∏—á—Ç–æ–∂–∞—é—Ç—Å—è
- **–°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è**: `particle.reset()` –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–¢–∏–ø—ã —á–∞—Å—Ç–∏—Ü:**
- **–ê—Ç–∞–∫–∞ –º–µ—á–æ–º**: –ë–µ–ª—ã–µ —á–∞—Å—Ç–∏—Ü—ã —Å –∫–æ—Ä–æ—Ç–∫–∏–º –≤—Ä–µ–º–µ–Ω–µ–º –∂–∏–∑–Ω–∏
- **–ú–∞–≥–∏—á–µ—Å–∫–∏–µ —Å–Ω–∞—Ä—è–¥—ã**: –¶–≤–µ—Ç–Ω—ã–µ —á–∞—Å—Ç–∏—Ü—ã —Å —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–µ–π
- **Dash —ç—Ñ—Ñ–µ–∫—Ç**: –ë—ã—Å—Ç—Ä—ã–µ —á–∞—Å—Ç–∏—Ü—ã —Å —Ä–∞–∑–º—ã—Ç–∏–µ–º
- **–ü–æ–ª—É—á–µ–Ω–∏–µ —É—Ä–æ–Ω–∞**: –ö—Ä–∞—Å–Ω—ã–µ —á–∞—Å—Ç–∏—Ü—ã —Å –ø—É–ª—å—Å–∞—Ü–∏–µ–π

## üéí –°–ò–°–¢–ï–ú–ê –ò–ù–í–ï–ù–¢–ê–†–Ø –ò –ü–†–ï–î–ú–ï–¢–û–í

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è

**–≠–∫–∏–ø–∏—Ä–æ–≤–∫–∞ (4 —Å–ª–æ—Ç–∞):**
```javascript
gameState.inventory.equipment = [
  null, // –û—Ä—É–∂–∏–µ
  null, // –ë—Ä–æ–Ω—è
  null, // –ê–∫—Å–µ—Å—Å—É–∞—Ä
  null  // –†–∞—Å—Ö–æ–¥–Ω–∏–∫
];
```

**–†—é–∫–∑–∞–∫ (20 —Å–ª–æ—Ç–æ–≤):**
```javascript
gameState.inventory.backpack = new Array(20).fill(null);
```

### –°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–º–µ—Ç–æ–≤

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–µ–¥–º–µ—Ç–∞:**
```javascript
{
  name: string,           // –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞
  type: string,           // –¢–∏–ø (weapon, armor, accessory, consumable)
  rarity: string,         // –†–µ–¥–∫–æ—Å—Ç—å (common, rare, legendary)
  level: number,          // –£—Ä–æ–≤–µ–Ω—å –ø—Ä–µ–¥–º–µ—Ç–∞
  bonus: {                // –ë–æ–Ω—É—Å—ã
    damage?: number,      // –£—Ä–æ–Ω
    defense?: number,     // –ó–∞—â–∏—Ç–∞
    maxHp?: number,       // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ
    heal?: number,        // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è
    crit?: number,        // –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —É—Ä–æ–Ω
    speed?: number        // –°–∫–æ—Ä–æ—Å—Ç—å
  }
}
```

### Drag & Drop —Å–∏—Å—Ç–µ–º–∞

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è:**
```javascript
static setupDragDropForSlot(slot, type, index) {
  slot.addEventListener('dragstart', (e) => {
    draggedItem = { type, index };
    slot.classList.add('dragging');
  });
  
  slot.addEventListener('dragover', (e) => {
    e.preventDefault();
    slot.classList.add('drag-over');
  });
  
  slot.addEventListener('drop', (e) => {
    e.preventDefault();
    this.handleDrop(draggedItem, { type, index });
  });
}
```

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è:**
```javascript
static handleDrop(from, to) {
  if (from.type === 'backpack' && to.type === 'equipment') {
    this.equipItem(from.index);
  } else if (from.type === 'equipment' && to.type === 'backpack') {
    this.unequipItem(from.index);
  }
}
```

### –°–∏—Å—Ç–µ–º–∞ –±–æ–Ω—É—Å–æ–≤

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –±–æ–Ω—É—Å–æ–≤:**
```javascript
static applyItemBonuses(item) {
  if (!item || !item.bonus) return;
  
  Object.entries(item.bonus).forEach(([stat, value]) => {
    switch (stat) {
      case 'damage':
        gameState.player.damage += value;
        break;
      case 'defense':
        gameState.player.defense += value;
        break;
      case 'maxHp':
        gameState.player.maxHp += value;
        break;
      case 'crit':
        gameState.player.crit += value;
        break;
      case 'speed':
        gameState.player.moveSpeed += value;
        break;
    }
  });
}
```

**–£–¥–∞–ª–µ–Ω–∏–µ –±–æ–Ω—É—Å–æ–≤:**
```javascript
static removeItemBonuses(item) {
  if (!item || !item.bonus) return;
  
  Object.entries(item.bonus).forEach(([stat, value]) => {
    switch (stat) {
      case 'damage':
        gameState.player.damage -= value;
        break;
      case 'defense':
        gameState.player.defense -= value;
        break;
      case 'maxHp':
        gameState.player.maxHp -= value;
        break;
      case 'crit':
        gameState.player.crit -= value;
        break;
      case 'speed':
        gameState.player.moveSpeed -= value;
        break;
    }
  });
}
```

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–µ–¥–º–µ—Ç–æ–≤

**–°–ª—É—á–∞–π–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã:**
```javascript
function generateRandomItem(level, characterClass) {
  const itemTypes = ['weapon', 'armor', 'accessory', 'consumable'];
  const rarities = ['common', 'rare', 'legendary'];
  
  const item = {
    name: generateItemName(),
    type: itemTypes[Math.floor(Math.random() * itemTypes.length)],
    rarity: rarities[Math.floor(Math.random() * rarities.length)],
    level: Math.max(1, level - 1 + Math.floor(Math.random() * 3)),
    bonus: generateItemBonus(level, characterClass)
  };
  
  return item;
}
```

**–ö–∞—á–µ—Å—Ç–≤–æ –ø—Ä–µ–¥–º–µ—Ç–æ–≤:**
```javascript
// –®–∞–Ω—Å –ø–æ—è–≤–ª–µ–Ω–∏—è –ø—Ä–µ–¥–º–µ—Ç–æ–≤
const baseItemChance = 0.3;
const levelBonus = Math.min(0.4, gameState.level * 0.03);
const itemChance = baseItemChance + levelBonus;

// –ö–∞—á–µ—Å—Ç–≤–æ –ø—Ä–µ–¥–º–µ—Ç–æ–≤
const minItemLevel = Math.max(1, gameState.level - 1);
const maxItemLevel = gameState.level + 1; // –ü—Ä–µ–¥–º–µ—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–∞ —É—Ä–æ–≤–µ–Ω—å –≤—ã—à–µ
```

## üë• –°–ò–°–¢–ï–ú–ê –ü–ï–†–°–û–ù–ê–ñ–ï–ô –ò –°–ü–û–°–û–ë–ù–û–°–¢–ï–ô

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π

**–ë–∞–∑–æ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
```javascript
const CHARACTERS = {
  'Dimon': {
    name: 'Dimon',
    class: '–ú–∞–≥',
    sprite: 'üßô‚Äç‚ôÇÔ∏è',
    abilityIcon: 'üî•',
    description: '–ú–æ–≥—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –º–∞–≥, –≤–ª–∞–¥–µ—é—â–∏–π –æ–≥–Ω–µ–Ω–Ω–æ–π –º–∞–≥–∏–µ–π',
    stats: {
      hp: 100,
      maxHp: 100,
      damage: 25,
      defense: 5,
      crit: 15,
      moveSpeed: 2.5,
      attackSpeed: 1.2,
      attackRadius: 120
    },
    ability: {
      name: '–û–≥–Ω–µ–Ω–Ω—ã–π —à–∞—Ä',
      cooldown: 8,
      damage: 50,
      range: 150
    }
  },
  'Andre': {
    name: 'Andre',
    class: '–í–æ–∏–Ω',
    sprite: '‚öîÔ∏è',
    abilityIcon: '‚ö°',
    description: '–û—Ç–≤–∞–∂–Ω—ã–π –≤–æ–∏–Ω —Å –º–æ—â–Ω—ã–º–∏ –∞—Ç–∞–∫–∞–º–∏',
    stats: {
      hp: 150,
      maxHp: 150,
      damage: 35,
      defense: 15,
      crit: 10,
      moveSpeed: 2.8,
      attackSpeed: 1.0,
      attackRadius: 80
    },
    ability: {
      name: 'Dash',
      cooldown: 5,
      distance: 100,
      duration: 0.3
    }
  },
  'Tim': {
    name: 'Tim',
    class: '–†–∞–∑–±–æ–π–Ω–∏–∫',
    sprite: 'üó°Ô∏è',
    abilityIcon: 'üí®',
    description: '–ë—ã—Å—Ç—Ä—ã–π –∏ –ª–æ–≤–∫–∏–π —Ä–∞–∑–±–æ–π–Ω–∏–∫',
    stats: {
      hp: 120,
      maxHp: 120,
      damage: 30,
      defense: 8,
      crit: 25,
      moveSpeed: 3.2,
      attackSpeed: 0.8,
      attackRadius: 60
    },
    ability: {
      name: '–°–∫—Ä—ã—Ç–Ω–æ—Å—Ç—å',
      cooldown: 12,
      duration: 3,
      invisibility: true
    }
  }
};
```

### –°–∏—Å—Ç–µ–º–∞ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π

**–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏:**
```javascript
// Dimon - –û–≥–Ω–µ–Ω–Ω—ã–π —à–∞—Ä
useFireball() {
  if (this.abilityCooldown > 0) return;
  
  const targetX = this.x + Math.cos(this.angle) * this.ability.range;
  const targetY = this.y + Math.sin(this.angle) * this.ability.range;
  
  const projectile = new Projectile(
    this.x, this.y, targetX, targetY,
    this.ability.damage, 'fireball'
  );
  
  gameState.entities.push(projectile);
  this.abilityCooldown = this.ability.cooldown;
  
  // –ó–≤—É–∫–æ–≤–æ–π —ç—Ñ—Ñ–µ–∫—Ç
  audioManager.playFireballAttack();
}

// Andre - Dash
useDash() {
  if (this.abilityCooldown > 0) return;
  
  const dashX = this.x + Math.cos(this.angle) * this.ability.distance;
  const dashY = this.y + Math.sin(this.angle) * this.ability.distance;
  
  this.x = dashX;
  this.y = dashY;
  this.abilityCooldown = this.ability.cooldown;
  
  // –ó–≤—É–∫–æ–≤–æ–π —ç—Ñ—Ñ–µ–∫—Ç
  audioManager.playDashSound();
}

// Tim - –°–∫—Ä—ã—Ç–Ω–æ—Å—Ç—å
useStealth() {
  if (this.abilityCooldown > 0) return;
  
  this.isInvisible = true;
  this.abilityCooldown = this.ability.cooldown;
  
  setTimeout(() => {
    this.isInvisible = false;
  }, this.ability.duration * 1000);
}
```

### –°–∏—Å—Ç–µ–º–∞ –∫—É–ª–¥–∞—É–Ω–æ–≤

**–í–∏–∑—É–∞–ª—å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã:**
```css
.ability-cooldown {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  border-radius: inherit;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 12px;
  font-weight: bold;
}

.ability-cooldown::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: conic-gradient(
    from 0deg,
    transparent 0deg,
    var(--color-primary) calc(var(--progress) * 360deg),
    transparent calc(var(--progress) * 360deg)
  );
  border-radius: inherit;
  mask: radial-gradient(circle at center, transparent 30%, black 31%);
}
```

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—É–ª–¥–∞—É–Ω–æ–≤:**
```javascript
static updateAbilityCooldown() {
  if (!gameState.player) return;
  
  if (gameState.player.abilityCooldown > 0) {
    gameState.player.abilityCooldown -= gameState.deltaTime;
  }
  
  // –û–±–Ω–æ–≤–ª—è–µ–º UI
  const cooldownText = document.querySelector('.cooldown-text');
  if (cooldownText) {
    const cooldown = Math.max(0, gameState.player.abilityCooldown);
    cooldownText.textContent = cooldown > 0 ? `${cooldown.toFixed(1)}s` : '–ì–æ—Ç–æ–≤';
  }
}
```

## üîß –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò

### –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

**–†–∞–∑–º–µ—Ä—ã –∏ –º–∞—Å—à—Ç–∞–±—ã:**
```javascript
const TILE_SIZE = 32;          // –†–∞–∑–º–µ—Ä —Ç–∞–π–ª–∞ –≤ –ø–∏–∫—Å–µ–ª—è—Ö
const MAP_SIZE = 50;           // –†–∞–∑–º–µ—Ä –∫–∞—Ä—Ç—ã –≤ —Ç–∞–π–ª–∞—Ö
const FPS_TARGET = 60;         // –¶–µ–ª–µ–≤–æ–π FPS
const FRAME_TIME = 1000 / FPS_TARGET; // –í—Ä–µ–º—è –∫–∞–¥—Ä–∞
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:**
```javascript
const ROOM_MIN_SIZE = 6;       // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∫–æ–º–Ω–∞—Ç—ã
const ROOM_MAX_SIZE = 12;      // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∫–æ–º–Ω–∞—Ç—ã
const MIN_ROOMS = 8;           // –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç
const MAX_ROOMS = 12;          // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç
```

### –°–∏—Å—Ç–µ–º–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç

**–ú–∏—Ä–æ–≤—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:**
- **–ò–≥—Ä–æ–∫**: `player.x, player.y` (–≤ –ø–∏–∫—Å–µ–ª—è—Ö)
- **–ö–∞–º–µ—Ä–∞**: `camera.x, camera.y` (–≤ –ø–∏–∫—Å–µ–ª—è—Ö)
- **–°—É—â–Ω–æ—Å—Ç–∏**: `entity.x, entity.y` (–≤ –ø–∏–∫—Å–µ–ª—è—Ö)

**–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ç–∞–π–ª–æ–≤:**
- **–ü–µ—Ä–µ–≤–æ–¥ –≤ —Ç–∞–π–ª—ã**: `Math.floor(worldX / TILE_SIZE)`
- **–ü–µ—Ä–µ–≤–æ–¥ –≤ –º–∏—Ä**: `tileX * TILE_SIZE`
- **–¶–µ–Ω—Ç—Ä —Ç–∞–π–ª–∞**: `(tileX + 0.5) * TILE_SIZE`

**–≠–∫—Ä–∞–Ω–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:**
- **–†–∞—Å—á–µ—Ç**: `worldX - camera.x`
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ**: `screenX * DPR` (–¥–ª—è Retina –¥–∏—Å–ø–ª–µ–µ–≤)

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–ö–ª—é—á–µ–≤—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
1. **–û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ç–æ–ª—å–∫–æ –≤–∏–¥–∏–º—ã—Ö —Ç–∞–π–ª–æ–≤** - —Ä–∞—Å—á–µ—Ç –≤–∏–¥–∏–º–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
2. **Object Pool –¥–ª—è —á–∞—Å—Ç–∏—Ü** - –∏–∑–±–µ–∂–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è/—É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤
3. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∫–æ–ª–ª–∏–∑–∏–π** - –¥–ª—è —Å—Ç–∞—Ç–∏—á–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
4. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–µ–ª—å—Ç–∞-–≤—Ä–µ–º–µ–Ω–∏** - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –±–æ–ª—å—à–∏—Ö —Å–∫–∞—á–∫–æ–≤
5. **–£—Å–ª–æ–≤–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥** - —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

**–ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- **FPS –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **–°—á–µ—Ç—á–∏–∫ –æ–±—ä–µ–∫—Ç–æ–≤**: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å—É—â–Ω–æ—Å—Ç–µ–π
- **–í—Ä–µ–º—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞**: –ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç—Ä–∏—Å–æ–≤–∫–∏

## üìã –ß–ï–ö–õ–ò–°–¢ –†–ê–ó–†–ê–ë–û–¢–ö–ò

### –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –º–µ—Ö–∞–Ω–∏–∫:

1. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º** - –æ–ø–∏—Å–∞—Ç—å –ø—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã
2. **–£–∫–∞–∑–∞—Ç—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** - –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
3. **–û–ø–∏—Å–∞—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏** - –∫–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä–æ–±–ª–µ–º —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é
4. **–î–æ–±–∞–≤–∏—Ç—å –≤ —Å–∏—Å—Ç–µ–º—É –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç** - –∫–∞–∫ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π
5. **–û–±–Ω–æ–≤–∏—Ç—å —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥** - –∫–∞–∫ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –Ω–æ–≤—É—é –º–µ—Ö–∞–Ω–∏–∫—É

### –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –º–µ—Ö–∞–Ω–∏–∫:

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - –Ω–µ —Å–ª–æ–º–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–∏—Å—Ç–µ–º—ã
2. **–û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é** - –æ—Ç—Ä–∞–∑–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
3. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - —É–±–µ–¥–∏—Ç—å—Å—è –≤ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–π
4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** - –∫–∞—Ä—Ç–∞, —Ç—É–º–∞–Ω –≤–æ–π–Ω—ã, –º–∏–Ω–∏–∫–∞—Ä—Ç–∞

### –ü—Ä–∏ –æ—Ç–ª–∞–¥–∫–µ –ø—Ä–æ–±–ª–µ–º:

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç** - –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–≤–æ–¥–æ–≤
2. **–£–±–µ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ç—É–º–∞–Ω–∞ –≤–æ–π–Ω—ã** - –≤–∏–¥–∏–º–æ—Å—Ç—å –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–ª–∏–∑–∏–∏** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–æ–∫ —Å—Ç–µ–Ω
4. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - FPS –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏

## üéØ –ö–õ–Æ–ß–ï–í–´–ï –ê–õ–ì–û–†–ò–¢–ú–´

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–¥–∑–µ–º–µ–ª–∏–π (BSP)
```javascript
// 1. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
while (partitions.length < MAX_ROOMS) {
  const partition = partitions.splice(randomIndex, 1)[0];
  const split = splitPartition(partition);
  if (split) partitions.push(split.left, split.right);
}

// 2. –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç
partitions.forEach(partition => {
  const room = createRoomInPartition(partition);
  if (room) {
    rooms.push(room);
    carveRoom(map, room);
  }
});

// 3. –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫–æ—Ä–∏–¥–æ—Ä–∞–º–∏
for (let i = 1; i < rooms.length; i++) {
  createCorridor(map, rooms[i - 1], rooms[i]);
}
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç—É–º–∞–Ω–∞ –≤–æ–π–Ω—ã
```javascript
// 1. –û—á–∏—Å—Ç–∫–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏
visible.forEach(row => row.fill(false));

// 2. –ö—Ä—É–≥–æ–≤–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
for (let dy = -radius; dy <= radius; dy++) {
  for (let dx = -radius; dx <= radius; dx++) {
    const distance = Math.hypot(dx, dy);
    if (distance <= radius) {
      const tileX = centerTileX + dx;
      const tileY = centerTileY + dy;
      
      if (tileX >= 0 && tileX < MAP_SIZE && tileY >= 0 && tileY < MAP_SIZE) {
        visible[tileY][tileX] = true;
        explored[tileY][tileX] = true;
      }
    }
  }
}
```

### –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∫–∞—Ä—Ç—ã —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π
```javascript
// 1. –†–∞—Å—á–µ—Ç –≤–∏–¥–∏–º–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
const startX = Math.floor(camera.x / TILE_SIZE) - 1;
const endX = Math.floor((camera.x + canvas.width / DPR) / TILE_SIZE) + 1;

// 2. –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ç–æ–ª—å–∫–æ –≤–∏–¥–∏–º—ã—Ö —Ç–∞–π–ª–æ–≤
for (let y = Math.max(0, startY); y < Math.min(MAP_SIZE, endY); y++) {
  for (let x = Math.max(0, startX); x < Math.min(MAP_SIZE, endX); x++) {
    const screenX = x * TILE_SIZE - camera.x;
    const screenY = y * TILE_SIZE - camera.y;
    
    if (map[y][x] === 1) {
      // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å—Ç–µ–Ω—ã
    } else {
      // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –ø–æ–ª–∞
    }
  }
}
```

### –°–∏—Å—Ç–µ–º–∞ –±–∞–Ω–æ–∫ –∑–¥–æ—Ä–æ–≤—å—è
```javascript
// 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ
static updateHealthPotions() {
  let healthPotionCount = 0;
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä—é–∫–∑–∞–∫
  gameState.inventory.backpack.forEach(item => {
    if (item && item.bonus && item.bonus.heal) {
      healthPotionCount++;
    }
  });
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —ç–∫–∏–ø–∏—Ä–æ–≤–∫—É
  if (gameState.inventory.equipment[3] && 
      gameState.inventory.equipment[3].bonus && 
      gameState.inventory.equipment[3].bonus.heal) {
    healthPotionCount++;
  }
  
  // –û–±–Ω–æ–≤–ª—è–µ–º UI
  potionCount.textContent = healthPotionCount;
  potionSlot.classList.toggle('empty', healthPotionCount === 0);
}

// 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∞–Ω–æ–∫
static useHealthPotion() {
  // –ò—â–µ–º –±–∞–Ω–∫—É –≤ —Ä—é–∫–∑–∞–∫–µ
  for (let i = 0; i < gameState.inventory.backpack.length; i++) {
    const item = gameState.inventory.backpack[i];
    if (item && item.bonus && item.bonus.heal) {
      // –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–∞–Ω–∫—É
      gameState.player.hp = Math.min(gameState.player.maxHp, 
                                     gameState.player.hp + item.bonus.heal);
      
      // –£–¥–∞–ª—è–µ–º –±–∞–Ω–∫—É –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
      gameState.inventory.backpack[i] = null;
      
      // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –∑–≤—É–∫
      audioManager.playHealthPotion();
      
      // –û–±–Ω–æ–≤–ª—è–µ–º UI
      this.updateHealthPotions();
      return;
    }
  }
}
```

### –°–∏—Å—Ç–µ–º–∞ —Ñ–æ–Ω–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
```css
/* –§–æ–Ω–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è —ç–∫—Ä–∞–Ω–æ–≤ */
.menu-background,
.select-background {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  z-index: 0;
}

.menu-background {
  background-image: url('Assets/Main.png');
}

.select-background {
  background-image: url('Assets/Characters.png');
}

/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
.menu-content,
.select-content {
  position: relative;
  z-index: 1;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}
```

### –ê—É–¥–∏–æ —Å–∏—Å—Ç–µ–º–∞ v2.0
```javascript
// 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
async init() {
  await this.loadMusicTracks();
  await this.loadSfxTracks();
  this.setupAudioResumeHandlers();
  
  setTimeout(() => {
    this.createAudioContextAndPlay();
  }, 1000);
}

// 2. –°–∏—Å—Ç–µ–º–∞ –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
setupAudioResumeHandlers() {
  const resumeAudio = () => {
    if (this.audioContext && this.audioContext.state === 'suspended') {
      this.audioContext.resume();
    }
    if (this.currentMusic && this.currentMusic.paused && gameState.audio.enabled) {
      this.currentMusic.play();
    }
  };

  ['click', 'touchstart', 'keydown', 'mousedown'].forEach(event => {
    document.addEventListener(event, resumeAudio, { once: false });
  });
}

// 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∏–≥—Ä–æ–≤—ã–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏
playSwordAttack() {
  this.playSfx('sword');
}

playDaggerAttack() {
  this.playSfx('Dagger');
}

playFireballAttack() {
  this.playSfx('Fireball');
}

playHealthPotion() {
  this.playSfx('health_potion');
}
```

–≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ–ª–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –≤—Å–µ—Ö –º–µ—Ö–∞–Ω–∏–∫ –∏–≥—Ä—ã, –≤–∫–ª—é—á–∞—è –Ω–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã —Ñ–æ–Ω–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –∞—É–¥–∏–æ —Å–∏—Å—Ç–µ–º—É v2.0, —Å–∏—Å—Ç–µ–º—É –±–∞–Ω–æ–∫ –∑–¥–æ—Ä–æ–≤—å—è –∏ —É–ª—É—á—à–µ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É –∑–¥–æ—Ä–æ–≤—å—è. –í—Å–µ —Å–∏—Å—Ç–µ–º—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ò –û–¢–õ–ê–î–ö–ê

### –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

**–ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```javascript
// –ê—É–¥–∏–æ —Å–∏—Å—Ç–µ–º–∞
console.log('üéµ Audio system initialization complete');
console.log('üéµ Auto-starting main music after audio context creation...');
console.log('üß™ Used health potion: +${item.bonus.heal} HP (${gameState.player.hp}/${gameState.player.maxHp})');

// –ò–≥—Ä–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è
console.log('üéÆ Level ${gameState.level} completed');
console.log('üéÆ Enemy spawned: ${enemy.type} at (${enemy.x}, ${enemy.y})');
console.log('üéÆ Item dropped: ${item.name} at (${item.x}, ${item.y})');
```

### –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

**FPS –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
```javascript
let frameCount = 0;
let lastTime = performance.now();

function updateFPS(currentTime) {
  frameCount++;
  
  if (currentTime - lastTime >= 1000) {
    const fps = Math.round((frameCount * 1000) / (currentTime - lastTime));
    console.log(`FPS: ${fps}`);
    frameCount = 0;
    lastTime = currentTime;
  }
}
```

**–ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**
```javascript
// –ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
const renderStart = performance.now();
render();
const renderTime = performance.now() - renderStart;

if (renderTime > 16.67) { // –ë–æ–ª—å—à–µ 60 FPS
  console.warn(`Slow render: ${renderTime.toFixed(2)}ms`);
}
```

### –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤:**
```
test_ability_buttons.html          # –¢–µ—Å—Ç –∫–Ω–æ–ø–æ–∫ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π
test_context_menu.html             # –¢–µ—Å—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã—Ö –º–µ–Ω—é
test_desktop_ability_button.html   # –¢–µ—Å—Ç –¥–µ—Å–∫—Ç–æ–ø–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫
test_inventory_drag_drop.html      # –¢–µ—Å—Ç –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ
test_local.html                    # –õ–æ–∫–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã
```

### –ß–µ–∫–ª–∏—Å—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- [ ] –ê—É–¥–∏–æ —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- [ ] –ë–∞–Ω–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç—Å—è –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
- [ ] –§–æ–Ω–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —ç–∫—Ä–∞–Ω–∞—Ö
- [ ] –°–∏—Å—Ç–µ–º–∞ –∑–¥–æ—Ä–æ–≤—å—è —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- [ ] –ü—Ä–µ–¥–º–µ—Ç—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è
- [ ] –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –º–µ–∂–¥—É —É—Ä–æ–≤–Ω—è–º–∏

**–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- [ ] FPS —Å—Ç–∞–±–∏–ª—å–Ω–æ 60 –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–µ
- [ ] FPS —Å—Ç–∞–±–∏–ª—å–Ω–æ 30+ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
- [ ] –ù–µ—Ç —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏
- [ ] –ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –∫–∞–º–µ—Ä—ã
- [ ] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –∫–∞—Ä—Ç—ã

**–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:**
- [ ] –†–∞–±–æ—Ç–∞–µ—Ç –≤ Chrome/Edge/Firefox
- [ ] –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ iOS Safari
- [ ] –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Android Chrome
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Retina –¥–∏—Å–ø–ª–µ–∏
- [ ] –†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ (offline)

### –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

**–ê—É–¥–∏–æ –≤ –±—Ä–∞—É–∑–µ—Ä–∞—Ö:**
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ë—Ä–∞—É–∑–µ—Ä—ã –±–ª–æ–∫–∏—Ä—É—é—Ç –∞–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
- **–†–µ—à–µ–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞—É–¥–∏–æ –ø—Ä–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏

**–ú–æ–±–∏–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ù–∏–∑–∫–∏–π FPS –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
- **–†–µ—à–µ–Ω–∏–µ**: –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤

**–ü–∞–º—è—Ç—å:**
- **–ü—Ä–æ–±–ª–µ–º–∞**: –£—Ç–µ—á–∫–∏ –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–π –∏–≥—Ä–µ
- **–†–µ—à–µ–Ω–∏–µ**: Object Pool –¥–ª—è —á–∞—Å—Ç–∏—Ü –∏ —Å—É—â–Ω–æ—Å—Ç–µ–π

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

1. **–í—Å–µ–≥–¥–∞ —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö** - –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–Ω–∞
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø–æ–º–æ–≥–∞–µ—Ç –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã
3. **–°–ª–µ–¥–∏—Ç–µ –∑–∞ FPS** - –∏–≥—Ä–æ–≤–æ–π –æ–ø—ã—Ç –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø–ª–∞–≤–Ω–æ—Å—Ç–∏
4. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∞—É–¥–∏–æ** - –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ä–∞–±–æ—Ç—É –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
5. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å** - UI –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –≤—Å–µ—Ö —ç–∫—Ä–∞–Ω–∞—Ö

–≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —è–≤–ª—è–µ—Ç—Å—è –ø–æ–ª–Ω—ã–º —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ–º –ø–æ –≤—Å–µ–º —Å–∏—Å—Ç–µ–º–∞–º –∏–≥—Ä—ã –∏ –ø–æ–º–æ–∂–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä–æ–±–ª–µ–º –ø—Ä–∏ –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ. 